{"version":3,"sources":["index.tsx"],"names":["React","useState","useEffect","View","Spinner","useOrder","useLanguage","useUtils","MaterialCommunityIcon","convertHoursToMinutes","BIContainer","BIHeader","BIContent","BIInfo","BIContentInfo","BITotal","BIActions","OAlert","OIcon","OText","BusinessItemAccordion","props","cart","moment","isCartsLoading","handleClearProducts","orderState","t","parsePrice","isCartPending","status","isClosed","valid_schedule","isProducts","products","length","isActive","setActiveState","cartsArray","Object","values","carts","cartsLength","filter","business","logo","borderRadius","name","options","type","display","flexDirection","alignItems","delivery_time","pickup_time","valid_products","total","onNavigationRedirect","store","slug","children"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAAkCC,SAAlC,QAAmD,OAAnD;AACA,SAASC,IAAT,QAAqB,cAArB;AACA,OAAOC,OAAP,MAAoB,sCAApB;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,QAAhC,QAA0D,4BAA1D;AACA,OAAOC,qBAAP,MAAkC,kDAAlC;AAEA,SAASC,qBAAT,QAAsC,aAAtC;AAEA,SACEC,WADF,EAEEC,QAFF,EAGEC,SAHF,EAIEC,MAJF,EAKEC,aALF,EAMEC,OANF,EAOEC,SAPF,QAQO,UARP;AASA,SAASC,MAAT,EAAiBC,KAAjB,EAAwBC,KAAxB,QAAqC,WAArC;AAEA,OAAO,MAAMC,qBAAqB,GAAIC,KAAD,IAAgB;AAAA;;AACnD,QAAM;AACJC,IAAAA,IADI;AAEJC,IAAAA,MAFI;AAGJC,IAAAA,cAHI;AAIJC,IAAAA;AAJI,MAKFJ,KALJ;AAOA,QAAM,CAACK,UAAD,IAAerB,QAAQ,EAA7B;AACA,QAAM,GAAGsB,CAAH,IAAQrB,WAAW,EAAzB;AACA,QAAM,CAAC;AAAEsB,IAAAA;AAAF,GAAD,IAAmBrB,QAAQ,EAAjC;AAEA,QAAMsB,aAAa,GAAG,CAAAP,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEQ,MAAN,MAAiB,CAAvC;AACA,QAAMC,QAAQ,GAAG,EAACT,IAAD,aAACA,IAAD,eAACA,IAAI,CAAEU,cAAP,CAAjB;AACA,QAAMC,UAAU,GAAGX,IAAH,aAAGA,IAAH,yCAAGA,IAAI,CAAEY,QAAT,mDAAG,eAAgBC,MAAnC;AAEA,QAAM,CAACC,QAAD,EAAWC,cAAX,IAA6BpC,QAAQ,CAAC,KAAD,CAA3C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AAAA;;AACd,UAAMoC,UAAU,GAAGC,MAAM,CAACC,MAAP,CAAcd,UAAd,aAAcA,UAAd,uBAAcA,UAAU,CAAEe,KAA1B,CAAnB;AACA,UAAMC,WAAW,4BAAGJ,UAAU,CAACK,MAAX,CAAmBrB,IAAD,IAAeA,IAAI,CAACY,QAAL,CAAcC,MAAd,GAAuB,CAAxD,EAA2DA,MAA9D,yEAAwE,CAAzF;;AACA,QAAKO,WAAW,KAAK,CAAjB,IAAuB,CAACX,QAA5B,EAAsC;AACpCM,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD;AACF,GANQ,EAMN,CAACX,UAAD,aAACA,UAAD,uBAACA,UAAU,CAAEe,KAAb,CANM,CAAT;AAQA,sBACE,oBAAC,WAAD;AAAa,IAAA,QAAQ,EAAEV;AAAvB,kBACE,oBAAC,QAAD;AACE,IAAA,QAAQ,EAAEA,QADZ;AAEE,IAAA,OAAO,EAAE,MAAM,CAACA,QAAD,GAAYM,cAAc,CAAC,CAACD,QAAF,CAA1B,GAAwCL;AAFzD,kBAIE,oBAAC,MAAD,QACG,CAAAT,IAAI,SAAJ,IAAAA,IAAI,WAAJ,8BAAAA,IAAI,CAAEsB,QAAN,kEAAgBC,IAAhB,kBACC,oBAAC,KAAD;AACE,IAAA,GAAG,EAAEvB,IAAF,aAAEA,IAAF,0CAAEA,IAAI,CAAEsB,QAAR,oDAAE,gBAAgBC,IADvB;AAEE,IAAA,KAAK,EAAE,EAFT;AAGE,IAAA,MAAM,EAAE,EAHV;AAIE,IAAA,KAAK,EAAE;AAAEC,MAAAA,YAAY,EAAE;AAAhB;AAJT,IAFJ,eASE,oBAAC,aAAD,qBACE,oBAAC,KAAD,QAAQxB,IAAR,aAAQA,IAAR,0CAAQA,IAAI,CAAEsB,QAAd,oDAAQ,gBAAgBG,IAAxB,CADF,EAEG,CAAArB,UAAU,SAAV,IAAAA,UAAU,WAAV,mCAAAA,UAAU,CAAEsB,OAAZ,4EAAqBC,IAArB,MAA8B,CAA9B,gBACC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,aAAa,EAAE,KAAlC;AAAyCC,MAAAA,UAAU,EAAE;AAArD;AAAb,kBACE,oBAAC,qBAAD;AACE,IAAA,IAAI,EAAC,eADP;AAEE,IAAA,IAAI,EAAE;AAFR,IADF,eAKE,oBAAC,KAAD,QAAQ3C,qBAAqB,CAACa,IAAD,aAACA,IAAD,0CAACA,IAAI,CAAEsB,QAAP,oDAAC,gBAAgBS,aAAjB,CAA7B,CALF,CADD,gBASC,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAAEH,MAAAA,OAAO,EAAE,MAAX;AAAmBC,MAAAA,aAAa,EAAE,KAAlC;AAAyCC,MAAAA,UAAU,EAAE;AAArD;AAAb,kBACE,oBAAC,qBAAD;AACE,IAAA,IAAI,EAAC,eADP;AAEE,IAAA,IAAI,EAAE;AAFR,IADF,eAKE,oBAAC,KAAD,QAAQ3C,qBAAqB,CAACa,IAAD,aAACA,IAAD,0CAACA,IAAI,CAAEsB,QAAP,oDAAC,gBAAgBU,WAAjB,CAA7B,CALF,CAXJ,CATF,CAJF,EAmCG,CAACvB,QAAD,IAAa,CAAC,CAACE,UAAf,iBACC,oBAAC,OAAD,QACG,CAAAX,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEiC,cAAN,KAAwB,CAAAjC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEkC,KAAN,IAAc,CAAtC,iBACC,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAC;AAAb,KAAqB5B,UAAU,CAACN,IAAD,aAACA,IAAD,uBAACA,IAAI,CAAEkC,KAAP,CAA/B,CAFJ,eAIE,oBAAC,KAAD,QAAQ7B,CAAC,CAAC,YAAD,EAAe,OAAf,CAAT,CAJF,CApCJ,EA4CGI,QAAQ,iBACP,oBAAC,OAAD,qBACE,oBAAC,KAAD,QAAQJ,CAAC,CAAC,QAAD,EAAW,QAAX,CAAT,OAAgCJ,MAAhC,CADF,CA7CJ,EAkDG,CAACQ,QAAD,IAAa,CAACE,UAAd,iBACC,oBAAC,OAAD,qBACE,oBAAC,KAAD,QAAQN,CAAC,CAAC,aAAD,EAAgB,aAAhB,CAAT,CADF,CAnDJ,eAwDE,oBAAC,SAAD,QACGN,KAAK,CAACoC,oBAAN,iBACC,oBAAC,qBAAD;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,IAAI,EAAE,EAFR;AAGE,IAAA,KAAK,EAAC,MAHR;AAIE,IAAA,OAAO,EAAE;AAAA;;AAAA,aAAMpC,KAAK,CAACoC,oBAAN,CAA2B,UAA3B,EAAuC;AAAEC,QAAAA,KAAK,EAAEpC,IAAF,aAAEA,IAAF,0CAAEA,IAAI,CAAEsB,QAAR,oDAAE,gBAAgBe;AAAzB,OAAvC,CAAN;AAAA;AAJX,IAFJ,EASG,CAAC5B,QAAD,IAAa,CAAC,CAACE,UAAf,iBACC,0CACG,CAACJ,aAAD,iBACC,oBAAC,MAAD;AACE,IAAA,KAAK,EAAEF,CAAC,CAAC,aAAD,EAAgB,aAAhB,CADV;AAEE,IAAA,OAAO,EAAEA,CAAC,CAAC,sBAAD,EAAyB,oDAAzB,CAFZ;AAGE,IAAA,QAAQ,EAAE,MAAMF,mBAAmB;AAHrC,kBAKE,oBAAC,qBAAD;AACE,IAAA,IAAI,EAAC,mBADP;AAEE,IAAA,IAAI,EAAE,EAFR;AAGE,IAAA,KAAK,EAAC;AAHR,IALF,CAFJ,eAcE,oBAAC,qBAAD;AAAuB,IAAA,IAAI,EAAC,cAA5B;AAA2C,IAAA,IAAI,EAAE;AAAjD,IAdF,CAVJ,CAxDF,CADF,eAuFE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAE;AAAEyB,MAAAA,OAAO,EAAEd,QAAQ,GAAG,MAAH,GAAY;AAA/B;AAAlB,KACGf,KAAK,CAACuC,QADT,CAvFF,eA0FE,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAEpC;AAAlB,IA1FF,CADF;AA8FD,CAxHM","sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { View } from 'react-native';\r\nimport Spinner from 'react-native-loading-spinner-overlay';\r\nimport { useOrder, useLanguage, useUtils, useEvent } from 'ordering-components/native';\r\nimport MaterialCommunityIcon from 'react-native-vector-icons/MaterialCommunityIcons';\r\n\r\nimport { convertHoursToMinutes } from '../../utils';\r\n\r\nimport {\r\n  BIContainer,\r\n  BIHeader,\r\n  BIContent,\r\n  BIInfo,\r\n  BIContentInfo,\r\n  BITotal,\r\n  BIActions\r\n} from './styles';\r\nimport { OAlert, OIcon, OText } from '../shared';\r\n\r\nexport const BusinessItemAccordion = (props: any) => {\r\n  const {\r\n    cart,\r\n    moment,\r\n    isCartsLoading,\r\n    handleClearProducts\r\n  } = props\r\n\r\n  const [orderState] = useOrder();\r\n  const [, t] = useLanguage();\r\n  const [{ parsePrice }] = useUtils();\r\n\r\n  const isCartPending = cart?.status === 2\r\n  const isClosed = !cart?.valid_schedule\r\n  const isProducts = cart?.products?.length\r\n\r\n  const [isActive, setActiveState] = useState(false)\r\n\r\n  useEffect(() => {\r\n    const cartsArray = Object.values(orderState?.carts)\r\n    const cartsLength = cartsArray.filter((cart: any) => cart.products.length > 0).length ?? 0\r\n    if ((cartsLength === 1) && !isClosed) {\r\n      setActiveState(true)\r\n    }\r\n  }, [orderState?.carts])\r\n\r\n  return (\r\n    <BIContainer isClosed={isClosed}>\r\n      <BIHeader\r\n        isClosed={isClosed}\r\n        onPress={() => !isClosed ? setActiveState(!isActive) : isClosed}\r\n      >\r\n        <BIInfo>\r\n          {cart?.business?.logo && (\r\n            <OIcon\r\n              url={cart?.business?.logo}\r\n              width={70}\r\n              height={70}\r\n              style={{ borderRadius: 16 }}\r\n            />\r\n          )}\r\n          <BIContentInfo>\r\n            <OText>{cart?.business?.name}</OText>\r\n            {orderState?.options?.type === 1 ? (\r\n              <View style={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\r\n                <MaterialCommunityIcon\r\n                  name='clock-outline'\r\n                  size={24}\r\n                />\r\n                <OText>{convertHoursToMinutes(cart?.business?.delivery_time)}</OText>\r\n              </View>\r\n            ) : (\r\n              <View style={{ display: 'flex', flexDirection: 'row', alignItems: 'center' }}>\r\n                <MaterialCommunityIcon\r\n                  name='clock-outline'\r\n                  size={24}\r\n                />\r\n                <OText>{convertHoursToMinutes(cart?.business?.pickup_time)}</OText>\r\n              </View>\r\n            )}\r\n          </BIContentInfo>\r\n        </BIInfo>\r\n\r\n        {!isClosed && !!isProducts && (\r\n          <BITotal>\r\n            {cart?.valid_products && cart?.total > 0 && (\r\n              <OText color='#000'>{parsePrice(cart?.total)}</OText>\r\n            )}\r\n            <OText>{t('CART_TOTAL', 'Total')}</OText>\r\n          </BITotal>\r\n        )}\r\n\r\n        {isClosed && (\r\n          <BITotal>\r\n            <OText>{t('CLOSED', 'Closed')} {moment}</OText>\r\n          </BITotal>\r\n        )}\r\n\r\n        {!isClosed && !isProducts && (\r\n          <BITotal>\r\n            <OText>{t('NO_PRODUCTS', 'No products')}</OText>\r\n          </BITotal>\r\n        )}\r\n\r\n        <BIActions>\r\n          {props.onNavigationRedirect && (\r\n            <MaterialCommunityIcon\r\n              name='store'\r\n              size={26}\r\n              color='#CCC'\r\n              onPress={() => props.onNavigationRedirect('Business', { store: cart?.business?.slug })}\r\n            />\r\n          )}\r\n          {!isClosed && !!isProducts && (\r\n            <>\r\n              {!isCartPending && (\r\n                <OAlert\r\n                  title={t('DELETE_CART', 'Delete Cart')}\r\n                  message={t('QUESTION_DELETE_CART', 'Are you sure to you wants delete the selected cart')}\r\n                  onAccept={() => handleClearProducts()}\r\n                >\r\n                  <MaterialCommunityIcon\r\n                    name='trash-can-outline'\r\n                    size={26}\r\n                    color='#D81212'\r\n                  />\r\n                </OAlert>\r\n              )}\r\n              <MaterialCommunityIcon name='chevron-down' size={20} />\r\n            </>\r\n          )}\r\n        </BIActions>\r\n      </BIHeader>\r\n\r\n      <BIContent style={{ display: isActive ? 'flex' : 'none' }}>\r\n        {props.children}\r\n      </BIContent>\r\n      <Spinner visible={isCartsLoading} />\r\n    </BIContainer>\r\n  )\r\n}\r\n"]}