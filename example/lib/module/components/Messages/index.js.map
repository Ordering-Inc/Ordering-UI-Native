{"version":3,"sources":["index.tsx"],"names":["React","useEffect","useState","Messages","MessagesController","useSession","useUtils","useLanguage","launchImageLibrary","GiftedChat","Actions","InputToolbar","Composer","Send","Bubble","MessageImage","USER_TYPE","ToastType","useToast","MaterialCommunityIcon","colors","OIcon","OIconButton","OText","TouchableOpacity","ActivityIndicator","StyleSheet","Header","TitleHeader","Wrapper","ImageDummy","require","paperIcon","MessagesUI","props","type","order","messages","image","message","messagesToShow","sendMessage","setMessage","handleSend","setImage","readMessages","user","parseDate","t","showToast","formattedMessages","setFormattedMessages","onChangeMessage","val","removeImage","handleImagePicker","mediaType","maxHeight","maxWidth","includeBase64","response","didCancel","console","log","errorMessage","Error","uri","url","base64","getStatus","status","onSubmit","values","messageConsole","change","attribute","old","parseInt","new","driver","name","lastname","comment","length","newMessages","created_at","app_id","toUpperCase","firstMessage","_id","text","createdAt","system","map","newMessage","can_see","includes","DRIVER","id","source","author","avatar","photo","business","logo","reverse","renderActions","styles","containerActions","white","lightGray","width","height","borderRadius","inputDisabled","position","top","right","borderColor","backgroundDark","backgroundColor","renderInputToolbar","padding","alignItems","justifyContent","renderComposer","paddingHorizontal","value","renderSend","loading","containerSend","opacity","primary","marginTop","marginRight","renderBubble","left","color","marginVertical","renderMessageImage","renderScrollToBottomComponent","paddingBottom","create","marginHorizontal","marginBottom","MessagesProps","UIComponent"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Messages as MessagesController, useSession, useUtils, useLanguage } from 'ordering-components/native'\r\nimport { launchImageLibrary } from 'react-native-image-picker'\r\nimport { GiftedChat, Actions, ActionsProps, InputToolbar, Composer, Send, Bubble, MessageImage, InputToolbarProps, ComposerProps } from 'react-native-gifted-chat'\r\nimport { USER_TYPE } from '../../config/constants'\r\nimport { ToastType, useToast } from '../../providers/ToastProvider'\r\nimport MaterialCommunityIcon from 'react-native-vector-icons/MaterialCommunityIcons'\r\nimport { colors } from '../../theme'\r\nimport { OIcon, OIconButton, OText } from '../shared'\r\nimport { TouchableOpacity, ActivityIndicator, StyleSheet } from 'react-native'\r\nimport { Header, TitleHeader, Wrapper } from './styles'\r\nimport { MessagesParams } from '../../types'\r\n\r\nconst ImageDummy = require('../../assets/images/image.png')\r\nconst paperIcon = require('../../assets/images/paper-plane.png')\r\n\r\nconst MessagesUI = (props: MessagesParams) => {\r\n\r\n  const {\r\n    type,\r\n    order,\r\n    messages,\r\n    image,\r\n    message,\r\n    messagesToShow,\r\n    sendMessage,\r\n    setMessage,\r\n    handleSend,\r\n    setImage,\r\n    readMessages,\r\n  } = props\r\n\r\n  const [{ user }] = useSession()\r\n  const [{ parseDate }] = useUtils()\r\n  const [, t] = useLanguage()\r\n  const { showToast } = useToast();\r\n\r\n  const [formattedMessages, setFormattedMessages] = useState<Array<any>>([])\r\n\r\n  const onChangeMessage = (val: string) => {\r\n    setMessage && setMessage(val)\r\n  }\r\n\r\n  const removeImage = () => {\r\n    setImage && setImage(null)\r\n  }\r\n\r\n  const handleImagePicker = () => {\r\n    launchImageLibrary({ mediaType: 'photo', maxHeight: 300, maxWidth: 300, includeBase64: true }, (response) => {\r\n      if (response.didCancel) {\r\n        console.log('User cancelled image picker');\r\n      } else if (response.errorMessage) {\r\n        console.log('ImagePicker Error: ', response.errorMessage);\r\n        showToast(ToastType.Error, response.errorMessage);\r\n      } else {\r\n        if (response.uri) {\r\n          const url = `data:${response.type};base64,${response.base64}`\r\n          setImage && setImage(url);\r\n        } else {\r\n          showToast(ToastType.Error, t('IMAGE_NOT_FOUND', 'Image not found'));\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const getStatus = (status: number) => {\r\n\r\n    switch (status) {\r\n      case 0:\r\n        return 'ORDER_STATUS_PENDING'\r\n      case 1:\r\n        return 'ORDERS_COMPLETED'\r\n      case 2:\r\n        return 'ORDER_REJECTED'\r\n      case 3:\r\n        return 'ORDER_STATUS_IN_BUSINESS'\r\n      case 4:\r\n        return 'ORDER_READY'\r\n      case 5:\r\n        return 'ORDER_REJECTED_RESTAURANT'\r\n      case 6:\r\n        return 'ORDER_STATUS_CANCELLEDBYDRIVER'\r\n      case 7:\r\n        return 'ORDER_STATUS_ACCEPTEDBYRESTAURANT'\r\n      case 8:\r\n        return 'ORDER_CONFIRMED_ACCEPTED_BY_DRIVER'\r\n      case 9:\r\n        return 'ORDER_PICKUP_COMPLETED_BY_DRIVER'\r\n      case 10:\r\n        return 'ORDER_PICKUP_FAILED_BY_DRIVER'\r\n      case 11:\r\n        return 'ORDER_DELIVERY_COMPLETED_BY_DRIVER'\r\n      case 12:\r\n        return 'ORDER_DELIVERY_FAILED_BY_DRIVER'\r\n      default:\r\n        return status\r\n    }\r\n  }\r\n\r\n  const onSubmit = (values: any) => {\r\n    handleSend && handleSend()\r\n    setImage && setImage(null)\r\n    setMessage && setMessage('')\r\n  }\r\n\r\n  const messageConsole = (message: any) => {\r\n    return message.change?.attribute !== 'driver_id'\r\n      ?\r\n      `${t('ORDER', 'Order')} ${message.change.attribute} ${t('CHANGED_FROM', 'Changed from')} ${message.change.old !== null && t(getStatus(parseInt(message.change.old, 10)))} ${t('TO', 'to')} ${t(getStatus(parseInt(message.change.new, 10)))}`\r\n      : message.change.new\r\n        ?\r\n        `${message.driver?.name} ${message.driver?.lastname !== null ? message.driver.lastname : ''} ${t('WAS_ASSIGNED_AS_DRIVER', 'Was assigned as driver')} ${message.comment ? message.comment.length : ''}`\r\n        :\r\n        `${t('DRIVER_UNASSIGNED', 'Driver unassigned')}`\r\n  }\r\n\r\n  useEffect(() => {\r\n    let newMessages: Array<any> = []\r\n    const console = `${t('ORDER_PLACED_FOR', 'Order placed for')} ${parseDate(order?.created_at)} ${t('VIA', 'Via')} ${order?.app_id ? t(order?.app_id.toUpperCase(), order?.app_id) : t('OTHER', 'Other')}`\r\n    const firstMessage = {\r\n      _id: 0,\r\n      text: console,\r\n      createdAt: order?.created_at,\r\n      system: true\r\n    }\r\n    messages.messages.map((message: any) => {\r\n      let newMessage\r\n      if (message.type !== 0 && (messagesToShow?.messages?.length || (message?.can_see?.includes('2')) || (message?.can_see?.includes('4') && type === USER_TYPE.DRIVER))) {\r\n        newMessage = {\r\n          _id: message.id,\r\n          text: message.type === 1 ? messageConsole(message) : message.comment,\r\n          createdAt: message.type !== 0 && message.created_at,\r\n          image: message.source,\r\n          system: message.type === 1,\r\n          user: {\r\n            _id: message.author.id,\r\n            name: message.author.name,\r\n            avatar: message.author.id !== user.id && type === USER_TYPE.DRIVER ? order?.driver?.photo : order?.business?.logo\r\n          }\r\n        }\r\n      }\r\n      if (message.type === 0) {\r\n        newMessage = firstMessage\r\n      }\r\n      newMessages = [...newMessages, newMessage]\r\n    })\r\n    setFormattedMessages([...newMessages.reverse()])\r\n  }, [messages.messages.length])\r\n\r\n  const renderActions = (props: Readonly<ActionsProps>) => {\r\n    return (\r\n      <Actions\r\n        {...props}\r\n        options={{\r\n          'Send Image': () => handleImagePicker(),\r\n        }}\r\n        containerStyle={styles.containerActions}\r\n        optionTintColor='#222845'\r\n        icon={() => (\r\n          <>\r\n            <OIconButton\r\n              borderColor={image ? colors.white : colors.lightGray}\r\n              style={{ width: 32, height: 32, borderRadius: 10 }}\r\n              icon={image ? { uri: image } : ImageDummy}\r\n              iconStyle={{ borderRadius: image ? 10 : 0, width: image ? 32 : 24, height: image ? 32 : 24 }}\r\n              onClick={handleImagePicker}\r\n              iconCover\r\n              bgColor={colors.inputDisabled}\r\n            />\r\n            {image && (\r\n              <TouchableOpacity\r\n                style={{ position: 'absolute', top: -5, right: -5, borderColor: colors.backgroundDark, backgroundColor: colors.white, borderRadius: 25 }}\r\n                onPress={() => removeImage()}\r\n              >\r\n                <MaterialCommunityIcon name='close-circle-outline' color={colors.backgroundDark} size={24} />\r\n              </TouchableOpacity>\r\n            )}\r\n          </>\r\n        )}\r\n      />\r\n    )\r\n  }\r\n\r\n  const renderInputToolbar = (props: InputToolbarProps) => (\r\n    <InputToolbar\r\n      {...props}\r\n      containerStyle={{\r\n        padding: 10,\r\n      }}\r\n      primaryStyle={{ alignItems: 'center', justifyContent: 'center' }}\r\n    />\r\n  )\r\n\r\n  const renderComposer = (props: ComposerProps) => (\r\n    <Composer\r\n      {...props}\r\n      textInputStyle={{\r\n        backgroundColor: colors.lightGray,\r\n        borderRadius: 25,\r\n        paddingHorizontal: 10,\r\n      }}\r\n      textInputProps={{\r\n        value: message\r\n      }}\r\n      placeholder={t('WRITE_MESSAGE', 'Write message...')}\r\n    />\r\n  )\r\n\r\n  const renderSend = (props: any) => (\r\n    <Send\r\n      {...props}\r\n      disabled={(sendMessage?.loading || (message === '' && !image) || messages?.loading)}\r\n      alwaysShowSend\r\n      containerStyle={styles.containerSend}\r\n    >\r\n      <OIconButton\r\n        onClick={onSubmit}\r\n        style={{\r\n          width: 54,\r\n          height: 32,\r\n          borderRadius: 25,\r\n          opacity: (sendMessage?.loading || (message === '' && !image) || messages?.loading) ? 0.4 : 1,\r\n          borderColor: colors.primary\r\n        }}\r\n        iconStyle={{ marginTop: 3, marginRight: 2 }}\r\n        icon={paperIcon}\r\n        disabled={(sendMessage?.loading || (message === '' && !image) || messages?.loading)}\r\n        disabledColor={colors.white}\r\n      />\r\n    </Send>\r\n  )\r\n\r\n  const renderBubble = (props: any) => (\r\n    <Bubble\r\n      {...props}\r\n      textStyle={{\r\n        left: {},\r\n        right: { color: colors.white }\r\n      }}\r\n      containerStyle={{\r\n        left: { marginVertical: 5 },\r\n        right: { marginVertical: 5 }\r\n      }}\r\n      wrapperStyle={{\r\n        left: { backgroundColor: '#f7f7f7', padding: 5 },\r\n        right: { backgroundColor: colors.primary, padding: 5 }\r\n      }}\r\n    />\r\n  )\r\n\r\n  const renderMessageImage = (props: any) => (\r\n    <MessageImage\r\n      {...props}\r\n    />\r\n  )\r\n\r\n  const renderScrollToBottomComponent = () => (\r\n    <MaterialCommunityIcon name='chevron-double-down' size={32} />\r\n  )\r\n\r\n  return (\r\n    <>\r\n      <Wrapper>\r\n        <Header>\r\n         <OIcon\r\n            url={type === USER_TYPE.DRIVER ? order?.driver?.photo : order?.business?.logo}\r\n            width={60}\r\n            height={60}\r\n            style={{ borderRadius: 10, marginRight: 10 }}\r\n          />\r\n          <TitleHeader>\r\n            <OText size={18}>{type === USER_TYPE.DRIVER ? order?.driver?.name : order?.business?.name}</OText>\r\n            <OText>{t('ONLINE', 'Online')}</OText>\r\n          </TitleHeader>\r\n        </Header>\r\n        <GiftedChat\r\n          messages={formattedMessages}\r\n          user={{\r\n            _id: user.id,\r\n            name: user.name,\r\n            avatar: user.photo\r\n          }}\r\n          onSend={onSubmit}\r\n          onInputTextChanged={onChangeMessage}\r\n          alignTop\r\n          scrollToBottom\r\n          renderAvatarOnTop\r\n          renderUsernameOnMessage\r\n          renderInputToolbar={renderInputToolbar}\r\n          renderComposer={renderComposer}\r\n          renderSend={renderSend}\r\n          renderActions={renderActions}\r\n          renderBubble={renderBubble}\r\n          renderMessageImage={renderMessageImage}\r\n          scrollToBottomComponent={() => renderScrollToBottomComponent()}\r\n          messagesContainerStyle={{\r\n            paddingBottom: 20\r\n          }}\r\n          showAvatarForEveryMessage\r\n          isLoadingEarlier={messages.loading}\r\n          renderLoading={() => <ActivityIndicator size=\"small\" color=\"#000\" />}\r\n        />\r\n      </Wrapper>\r\n    </>\r\n  )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  containerActions: {\r\n    width: 44,\r\n    height: 44,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    marginHorizontal: 4,\r\n    marginBottom: 0\r\n  },\r\n  containerSend: {\r\n    width: 64,\r\n    height: 44,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    marginHorizontal: 4\r\n  }\r\n})\r\n\r\nexport const Messages = (props: MessagesParams) => {\r\n  const MessagesProps = {\r\n    ...props,\r\n    UIComponent: MessagesUI\r\n  }\r\n  return <MessagesController {...MessagesProps} />\r\n}\r\n"]}