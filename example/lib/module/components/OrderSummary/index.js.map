{"version":3,"sources":["index.tsx"],"names":["React","useState","Cart","useOrder","useLanguage","useUtils","useValidationFields","OSContainer","OSProductList","OSBill","OSTable","OSTotal","OSCoupon","ProductItemAccordion","CouponControl","OModal","OText","colors","ProductForm","OrderSummaryUI","props","currentCartUuid","cart","clearCart","isProducts","changeQuantity","getProductMax","offsetDisabled","removeProduct","onClickCheckout","isCheckout","isCartPending","isCartPopover","isForceOpenCart","isCartOnProductsList","handleCartOpen","t","orderState","parsePrice","parseNumber","parseDate","validationFields","openProduct","setModalIsOpen","curProduct","setCurProduct","isCouponEnabled","fields","checkout","coupon","enabled","handleDeleteClick","product","handleEditProduct","handlerProductAction","Object","keys","length","products","map","code","subtotal","business","tax_type","tax","options","type","delivery_price","driver_tip","driver_tip_rate","service_fee","discount","total","discount_type","discount_rate","business_id","marginTop","fontWeight","primary","slug","category_id","id","OrderSummary","orderSummaryProps","UIComponent"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n  Cart,\r\n  useOrder,\r\n  useLanguage,\r\n  useEvent,\r\n  useUtils,\r\n  useValidationFields,\r\n} from 'ordering-components/native';\r\n\r\nimport {\r\n  OSContainer,\r\n  OSProductList,\r\n  OSBill,\r\n  OSTable,\r\n  OSTotal,\r\n  OSCoupon\r\n} from './styles';\r\n\r\nimport { ProductItemAccordion } from '../ProductItemAccordion';\r\nimport { CouponControl } from '../CouponControl';\r\nimport { OModal, OText } from '../shared';\r\nimport { colors } from '../../theme';\r\nimport { ProductForm } from '../ProductForm';\r\n\r\n\r\nconst OrderSummaryUI = (props: any) => {\r\n  const {\r\n    currentCartUuid,\r\n    cart,\r\n    clearCart,\r\n    isProducts,\r\n    changeQuantity,\r\n    getProductMax,\r\n    offsetDisabled,\r\n    removeProduct,\r\n    onClickCheckout,\r\n    isCheckout,\r\n    isCartPending,\r\n    isCartPopover,\r\n    isForceOpenCart,\r\n    isCartOnProductsList,\r\n    handleCartOpen\r\n  } = props;\r\n\r\n  const [, t] = useLanguage();\r\n  const [orderState] = useOrder();\r\n  const [{ parsePrice, parseNumber, parseDate }] = useUtils();\r\n  const [validationFields] = useValidationFields();\r\n  const [openProduct, setModalIsOpen] = useState(false)\r\n  const [curProduct, setCurProduct] = useState<any>(null)\r\n\r\n  const isCouponEnabled = validationFields?.fields?.checkout?.coupon?.enabled;\r\n\r\n  const handleDeleteClick = (product: any) => {\r\n    removeProduct(product)\r\n  }\r\n\r\n  const handleEditProduct = (product: any) => {\r\n    setCurProduct(product)\r\n    setModalIsOpen(true)\r\n  }\r\n\r\n  const handlerProductAction = (product: any) => {\r\n    if (Object.keys(product).length) {\r\n      setModalIsOpen(false)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <OSContainer>\r\n      {cart?.products?.length > 0 && (\r\n        <>\r\n          <OSProductList>\r\n            {cart?.products.map((product: any) => (\r\n              <ProductItemAccordion\r\n                key={product.code}\r\n                product={product}\r\n                isCartPending={isCartPending}\r\n                isCartProduct\r\n                changeQuantity={changeQuantity}\r\n                getProductMax={getProductMax}\r\n                offsetDisabled={offsetDisabled}\r\n                onDeleteProduct={handleDeleteClick}\r\n                onEditProduct={handleEditProduct}\r\n              />\r\n            ))}\r\n          </OSProductList>\r\n          <OSBill>\r\n            <OSTable>\r\n              <OText>{t('SUBTOTAL', 'Subtotal')}</OText>\r\n              <OText>{parsePrice(cart?.subtotal || 0)}</OText>\r\n            </OSTable>\r\n            <OSTable>\r\n              <OText>\r\n                {\r\n                  cart.business.tax_type === 1\r\n                    ? t('TAX_INCLUDED', 'Tax (included)')\r\n                    : t('TAX', 'Tax')\r\n                }\r\n                {`(${parseNumber(cart?.business?.tax)}%)`}\r\n              </OText>\r\n              <OText>{parsePrice(cart?.tax || 0)}</OText>\r\n            </OSTable>\r\n            {orderState?.options?.type === 1 && cart?.delivery_price > 0 && (\r\n              <OSTable>\r\n                <OText>{t('DELIVERY_FEE', 'Delivery Fee')}</OText>\r\n                <OText>{parsePrice(cart?.delivery_price)}</OText>\r\n              </OSTable>\r\n            )}\r\n            {cart?.driver_tip > 0 && (\r\n              <OSTable>\r\n                <OText>\r\n                  {t('DRIVER_TIP', 'Driver tip')}\r\n                  {(cart?.driver_tip_rate > 0) && (\r\n                    `(${parseNumber(cart?.driver_tip_rate)}%)`\r\n                  )}\r\n                </OText>\r\n                <OText>{parsePrice(cart?.driver_tip)}</OText>\r\n              </OSTable>\r\n            )}\r\n            {cart?.service_fee > 0 && (\r\n              <OSTable>\r\n                <OText>\r\n                  {t('SERVICE_FEE', 'Service Fee')}\r\n                  {`(${parseNumber(cart?.business?.service_fee)}%)`}\r\n                </OText>\r\n                <OText>{parsePrice(cart?.service_fee)}</OText>\r\n              </OSTable>\r\n            )}\r\n            {cart?.discount > 0 && cart?.total >= 0 && (\r\n              <OSTable>\r\n                {cart?.discount_type === 1 ? (\r\n                  <OText>\r\n                    {t('DISCOUNT', 'Discount')}\r\n                    <OText>{`(${parseNumber(cart?.discount_rate)}%)`}</OText>\r\n                  </OText>\r\n                ) : (\r\n                  <OText>{t('DISCOUNT', 'Discount')}</OText>\r\n                )}\r\n                <OText>- {parsePrice(cart?.discount || 0)}</OText>\r\n              </OSTable>\r\n            )}\r\n            {isCouponEnabled && !isCartPending && (\r\n              <OSTable>\r\n                <OSCoupon>\r\n                  <CouponControl\r\n                    businessId={cart.business_id}\r\n                    price={cart.total}\r\n                  />\r\n                </OSCoupon>\r\n              </OSTable>\r\n            )}\r\n            <OSTotal>\r\n              <OSTable style={{ marginTop: 15 }}>\r\n                <OText style={{ fontWeight: 'bold' }}>\r\n                  {t('TOTAL', 'Total')}\r\n                </OText>\r\n                <OText style={{ fontWeight: 'bold' }} color={colors.primary}>\r\n                  {cart?.total >= 1 && parsePrice(cart?.total)}\r\n                </OText>\r\n              </OSTable>\r\n            </OSTotal>\r\n          </OSBill>\r\n          <OModal\r\n            open={openProduct}\r\n            entireModal\r\n            customClose\r\n            onClose={() => setModalIsOpen(false)}\r\n          >\r\n            <ProductForm\r\n              isCartProduct\r\n              productCart={curProduct}\r\n              businessSlug={cart?.business?.slug}\r\n              businessId={curProduct?.business_id}\r\n              categoryId={curProduct?.category_id}\r\n              productId={curProduct?.id}\r\n              onSave={handlerProductAction}\r\n              onClose={() => setModalIsOpen(false)}\r\n            />\r\n          </OModal>\r\n        </>\r\n      )}\r\n    </OSContainer>\r\n  )\r\n}\r\n\r\nexport const OrderSummary = (props: any) => {\r\n  const orderSummaryProps = {\r\n    ...props,\r\n    UIComponent: OrderSummaryUI\r\n  }\r\n\r\n  return (\r\n    <Cart {...orderSummaryProps} />\r\n  )\r\n}\r\n"]}