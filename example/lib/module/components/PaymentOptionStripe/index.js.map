{"version":3,"sources":["index.tsx"],"names":["React","useState","View","StyleSheet","Dimensions","FlatList","KeyboardAvoidingView","Platform","PaymentOptionStripe","PaymentOptionStripeController","useSession","useLanguage","PlaceholderLine","MaterialCommunityIcons","getIconCard","OAlert","OButton","OModal","OText","NotFoundSource","StripeElementsForm","OSContainer","OSItem","OSItemContent","OSItemActions","OSWrapper","OSActions","colors","PaymentOptionStripeUI","props","onSelectCard","onCancel","deleteCard","cardSelected","cardsList","handleCardClick","handleNewCard","token","t","addCartOpen","setAddCardOpen","_handleNewCard","card","handleDeleteCard","renderCards","item","id","styles","viewStyle","primary","brand","last4","container","loading","cards","length","error","message","toString","height","flexGrow","bottom","btnAddStyle","color","width","backgroundGray","btnAction","OS","businessId","publicKey","clientSecret","Array","map","_","i","marginVertical","screenHeight","get","create","position","marginBottom","marginRight","marginTop","paddingHorizontal","paymentOptionStripeProps","UIComponent"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport { View, StyleSheet, Dimensions, FlatList, KeyboardAvoidingView, Platform } from 'react-native';\r\nimport {\r\n  PaymentOptionStripe as PaymentOptionStripeController,\r\n  useSession,\r\n  useLanguage\r\n} from 'ordering-components/native';\r\nimport { PlaceholderLine } from 'rn-placeholder';\r\nimport MaterialCommunityIcons from 'react-native-vector-icons/MaterialCommunityIcons';\r\n\r\nimport { getIconCard } from '../../utils';\r\nimport { OAlert, OButton, OModal, OText } from '../shared';\r\n\r\nimport { NotFoundSource } from '../NotFoundSource';\r\nimport { StripeElementsForm } from '../StripeElementsForm';\r\n\r\nimport {\r\n  OSContainer,\r\n  OSMessage,\r\n  OSItem,\r\n  OSItemContent,\r\n  OSItemActions,\r\n  OSWrapper,\r\n  OSActions\r\n} from './styles';\r\nimport { colors } from '../../theme';\r\n\r\nconst PaymentOptionStripeUI = (props: any) => {\r\n  const {\r\n    onSelectCard,\r\n    onCancel,\r\n    deleteCard,\r\n    cardSelected,\r\n    cardsList,\r\n    handleCardClick,\r\n    handleNewCard\r\n  } = props;\r\n\r\n  const [{ token }] = useSession();\r\n  const [, t] = useLanguage();\r\n\r\n  const [addCartOpen, setAddCardOpen] = useState(false)\r\n\r\n  const _handleNewCard = (card: any) => {\r\n    setAddCardOpen(false);\r\n    handleNewCard(card);\r\n  }\r\n\r\n  const handleDeleteCard = (card: any) => {\r\n    deleteCard(card);\r\n  };\r\n\r\n  const renderCards = ({ item }: any) => {\r\n    return (\r\n      <OSItem key={item.id}>\r\n        <OSItemContent onPress={() => handleCardClick(item)}>\r\n          <View style={styles.viewStyle}>\r\n            {item.id === cardSelected?.id ? (\r\n              <MaterialCommunityIcons\r\n                name='radiobox-marked'\r\n                size={24}\r\n                color={colors.primary}\r\n              />\r\n            ) : (\r\n              <MaterialCommunityIcons\r\n                name='radiobox-blank'\r\n                size={24}\r\n                color={colors.primary}\r\n              />\r\n            )}\r\n          </View>\r\n          <View style={styles.viewStyle}>\r\n            {getIconCard(item.brand, 26)}\r\n          </View>\r\n          <View style={styles.viewStyle}>\r\n            <OText size={20}>\r\n              XXXX-XXXX-XXXX-{item.last4}\r\n            </OText>\r\n          </View>\r\n        </OSItemContent>\r\n        <OSItemActions>\r\n          <OAlert\r\n            title={t('CARD', 'Card')}\r\n            message={t('QUESTION_DELETE_CARD', 'Are you sure that you want to delete the card?')}\r\n            onAccept={() => handleDeleteCard(item)}\r\n          >\r\n            <MaterialCommunityIcons\r\n              name='trash-can-outline'\r\n              size={28}\r\n              color={colors.primary}\r\n            />\r\n          </OAlert>\r\n        </OSItemActions>\r\n      </OSItem>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <OSContainer style={styles.container}>\r\n      {token && !cardsList.loading && cardsList.cards && cardsList.cards.length === 0 && (\r\n        <OSItem>\r\n          <OText size={22}>\r\n            {t('YOU_DONT_HAVE_CARDS', 'You don\\'t have cards')}\r\n          </OText>\r\n        </OSItem>\r\n      )}\r\n\r\n      {token && cardsList.error && cardsList.error.length > 0 && (\r\n        <NotFoundSource\r\n          content={cardsList?.error[0]?.message || cardsList?.error[0]}\r\n        />\r\n      )}\r\n\r\n      {token && cardsList.cards && cardsList.cards.length > 0 && (\r\n        <FlatList\r\n          horizontal={false}\r\n          showsHorizontalScrollIndicator={false}\r\n          data={cardsList.cards}\r\n          renderItem={renderCards}\r\n          keyExtractor={card => card.id?.toString()}\r\n          style={{ height: '65%', flexGrow: 0 }}\r\n        />\r\n      )}\r\n\r\n      {token && !cardsList.loading && (\r\n        <OSWrapper style={styles.bottom}>\r\n          <OButton\r\n            text={t('ADD_PAYMENT_CARD', 'Add New Payment Card')}\r\n            bgColor={colors.primary}\r\n            borderColor={colors.primary}\r\n            style={styles.btnAddStyle}\r\n            textStyle={{color: 'white'}}\r\n            imgRightSrc={null}\r\n            onClick={() => setAddCardOpen(true)}\r\n          />\r\n          <OSActions>\r\n            <View style={{ width: '48%' }}>\r\n              <OButton\r\n                text={t('CANCEL', 'Cancel')}\r\n                bgColor={colors.backgroundGray}\r\n                borderColor={colors.backgroundGray}\r\n                textStyle={{color: 'white'}}\r\n                style={styles.btnAction}\r\n                imgRightSrc={null}\r\n                onClick={() => onCancel()}\r\n              />\r\n            </View>\r\n            <View style={{ width: '48%' }}>\r\n              <OButton\r\n                text={t('ACCEPT', 'Accept')}\r\n                bgColor={colors.primary}\r\n                borderColor={colors.primary}\r\n                textStyle={{color: 'white'}}\r\n                style={styles.btnAction}\r\n                imgRightSrc={null}\r\n                isDisabled={!cardSelected || cardsList?.cards?.length === 0}\r\n                onClick={() => onSelectCard(cardSelected)}\r\n              />\r\n            </View>\r\n          </OSActions>\r\n        </OSWrapper>\r\n      )}\r\n\r\n      <OModal\r\n        isNotDecoration\r\n        title={t('ADD_CREDIT_OR_DEBIT_CARD', 'Add credit or debit card')}\r\n        open={addCartOpen}\r\n        onClose={() => setAddCardOpen(false)}\r\n      >\r\n        <KeyboardAvoidingView\r\n          behavior={Platform.OS == 'ios' ? 'padding' : 'height'}\r\n          keyboardVerticalOffset={Platform.OS == 'ios' ? 0 : 0}\r\n          enabled={Platform.OS === 'ios' ? true : false}\r\n        >\r\n          <StripeElementsForm\r\n            toSave\r\n            businessId={props.businessId}\r\n            publicKey={props.publicKey}\r\n            requirements={props.clientSecret}\r\n            onNewCard={_handleNewCard}\r\n            onCancel={() => setAddCardOpen(false)}\r\n          />\r\n        </KeyboardAvoidingView>\r\n      </OModal>\r\n\r\n      {token && cardsList.loading && (\r\n        <>\r\n          {[...Array(5)].map((_, i) => (\r\n            <PlaceholderLine\r\n              key={i}\r\n              height={50}\r\n              width={90}\r\n              noMargin\r\n              style={{ marginVertical: 20 }}\r\n            />\r\n          ))}\r\n        </>\r\n      )}\r\n    </OSContainer>\r\n  )\r\n}\r\n\r\nconst screenHeight = Dimensions.get('window').height;\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    height: screenHeight - 90\r\n  },\r\n  bottom: {\r\n    position: 'absolute',\r\n    bottom: 0,\r\n    marginBottom: 20\r\n  },\r\n  viewStyle: {\r\n    marginRight: 10\r\n  },\r\n  btnAddStyle: {\r\n    marginTop: 20\r\n  },\r\n  btnAction: {\r\n    paddingHorizontal: 20\r\n  }\r\n})\r\n\r\nexport const PaymentOptionStripe = (props: any) => {\r\n  const paymentOptionStripeProps = {\r\n    ...props,\r\n    UIComponent: PaymentOptionStripeUI\r\n  }\r\n  return (\r\n    <PaymentOptionStripeController {...paymentOptionStripeProps} />\r\n  )\r\n}\r\n"]}